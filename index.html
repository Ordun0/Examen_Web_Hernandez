<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <meta name="description" content="Gu√≠a oficial del Parque Nacional Altamira: rutas, fauna, flora y planificaci√≥n de visitas.">
  <title>Parque Nacional Altamira</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Ovo&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./css/normalize.css">
  <link rel="stylesheet" href="./css/styles.css">
</head>
<body>

  <header class="header" id="inicio">
    <div class="container">
      <div class="barra">
        <a class="logo" href="#inicio">
          <img src="./images/logo.png" alt="Logo del Parque Nacional Altamira" class="logo-img">
        </a>
        <input type="checkbox" id="menu-toggle" class="menu-toggle" aria-label="Alternar men√∫">
        <label for="menu-toggle" class="hamburger">
          <span></span>
          <span></span>
          <span></span>
        </label>
        <nav class="navegacion">
          <a href="#inicio" class="navegacion_enlace">Inicio</a>
          <a href="#rutas" class="navegacion_enlace">Rutas</a>
          <a href="#fauna" class="navegacion_enlace">Fauna & Flora</a>
          <a href="#registro" class="navegacion_enlace">Registro</a>
        </nav>
        <label for="menu-toggle" class="menu-overlay"></label>
      </div>
    </div>

    <div class="hero-collage">
      <div class="hero-item"><img src="./images/hero1.jpg" alt="Mirador del C√≥ndor al amanecer"></div>
      <div class="hero-item"><img src="./images/hero2.jpg" alt="Ca√±√≥n del R√≠o Claro"></div>
      <div class="hero-item"><img src="./images/hero3.jpg" alt="Floraci√≥n de puya raimondi"></div>
      <div class="hero-item"><img src="./images/hero4.jpg" alt="Lago Esmeralda en Altamira"></div>
    </div>

    <div class="hero-overlay">
      <h2 class="no-margin">Descubre la grandeza silvestre</h2>
      <a class="btn-cta" href="#registro">Planifica tu visita</a>
      <p><small>* Entrada gratuita los domingos</small></p>
    </div> 
  </header>
  
  <section id="rutas" class="rightdesign">
    <img src="./images/mirador.jpg" alt="Vista panor√°mica desde el Mirador del C√≥ndor">
    <div class="content-wrapper">
      <span>RUTAS DESTACADAS</span>
      <h2>Mirador del C√≥ndor: amanecer entre nubes</h2>
      <p>Sendero de dificultad f√°cil (2 km ida y vuelta), ideal para familias y fot√≥grafos. Parte desde el Centro de Visitantes y culmina en un mirador a 2,800 msnm con vistas al valle andino.</p>
      <p>Recomendado llevar agua, bloqueador solar y binoculares para avistamiento de aves.</p>

      <h3 class="tabla-titulo">Rutas disponibles en el Parque Nacional</h3>
      <div id="rutas-container">
        <!-- Las rutas se cargar√°n din√°micamente desde la base de datos -->
        <div class="ruta-loading">Cargando rutas...</div>
      </div>
    </div>
  </section>

  <section id="fauna" class="new-features">
    <div class="container">
      <div class="features-content">
        <span>FAUNA Y FLORA</span>
        <h2>Especies que podr√°s encontrar</h2>
        <ul class="features-list">
          <!-- Animales (6) -->
          <li>
            <figure>
              <img src="./images/condor.jpg" alt="C√≥ndor Andino en vuelo">
              <figcaption>C√≥ndor Andino</figcaption>
            </figure>
            <p>Ave nacional en peligro de extinci√≥n. Vuela en t√©rmicas a m√°s de 5,000 msnm.</p>
          </li>
          <li>
            <figure>
              <img src="./images/puma.jpg" alt="Puma escondido entre rocas">
              <figcaption>Puma</figcaption>
            </figure>
            <p>Depredador tope. Avistamiento raro: principalmente al amanecer o atardecer.</p>
          </li>
          <li>
            <figure>
              <img src="./images/zorro.jpg" alt="Zorro culpeo andino">
              <figcaption>Zorro Culpeo</figcaption>
            </figure>
            <p>El m√°s grande de Sudam√©rica. Se alimenta de roedores y frutos silvestres.</p>
          </li>
          <li>
            <figure>
              <img src="./images/viscacha.jpg" alt="Viscacha andina en rocas">
              <figcaption>Viscacha</figcaption>
            </figure>
            <p>Pariente del chinchilla. Vive en colonias en zonas rocosas por encima de los 3,000 msnm.</p>
          </li>
          <li>
            <figure>
              <img src="./images/aguila.jpg" alt="√Åguila mora volando">
              <figcaption>√Åguila Mora</figcaption>
            </figure>
            <p>Rapaz de gran envergadura. Se alimenta de serpientes y peque√±os mam√≠feros.</p>
          </li>
          <li>
            <figure>
              <img src="./images/suri.jpg" alt="Suri (√±and√∫ andino) caminando">
              <figcaption>Suri</figcaption>
            </figure>
            <p>Ave no voladora, end√©mica de la puna. En peligro por caza furtiva.</p>
          </li>

          <li>
            <figure>
              <img src="./images/puya.jpg" alt="Puya Raimondi con flores moradas">
              <figcaption>Puya Raimondi</figcaption>
            </figure>
            <p>Florece cada 80‚Äì100 a√±os. Atrae a cientos de aves y polinizadores durante su floraci√≥n.</p>
          </li>
          <li>
            <figure>
              <img src="./images/quina.jpg" alt="√Årbol de quina con corteza rojiza">
              <figcaption>Quina</figcaption>
            </figure>
            <p>√Årbol medicinal. Su corteza dio origen a la quinina, usada contra la malaria.</p>
          </li>
          <li>
            <figure>
              <img src="./images/romerillo.jpg" alt="Romerillo andino, arbusto bajo">
              <figcaption>Romerillo</figcaption>
            </figure>
            <p>Arbusto arom√°tico usado en rituales ancestrales y como repelente natural.</p>
          </li>
        </ul>
        <audio controls class="audio-player">
          <source src="./media/canto-condor.mp3" type="audio/mpeg">
          Tu navegador no soporta el elemento de audio.
        </audio>
        <small class="audio-label">Grabaci√≥n del grito del c√≥ndor andino (Zona Mirador, 06:17 hrs)</small>
      </div>
    </div>
  </section>

  <section class="leftdesign">
    <img src="./images/canyon.jpg" alt="Ca√±√≥n del R√≠o Claro con paredes rocosas">
    <div class="content-wrapper">
      <span>EXPERIENCIA INMERSIVA</span>
      <h2>Vuelo del c√≥ndor: grabado en 4K</h2>
      <p>Este video fue grabado por drones autorizados en colaboraci√≥n con la Sociedad Ornitol√≥gica Andina.</p>

      <video controls poster="./images/poster-video.jpg" class="video-player">
        <source src="./media/condor-flight.webm" type="video/mp4">
        Tu navegador no soporta el elemento de video.
      </video>

      <ul class="stats-list">
        <li><span class="stat-number">45+</span><br><small>km de senderos</small></li>
        <li><span class="stat-number">12</span><br><small>especies registradas</small></li>
        <li><span class="stat-number">97%</span><br><small>satisfacci√≥n visitantes</small></li>
      </ul>

      <ul class="testimonials-list">
        <li>
          <div class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
          <blockquote>‚ÄúLa ruta al Mirador del C√≥ndor fue una experiencia espiritual.‚Äù</blockquote>
          <cite>‚Äî Ana M., Gu√≠a de monta√±a</cite>
        </li>
        <li>
          <div class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
          <blockquote>‚ÄúCaptur√© el c√≥ndor en vuelo‚Ä¶ un sue√±o cumplido.‚Äù</blockquote>
          <cite>‚Äî Carlos R., Fot√≥grafo naturalista</cite>
        </li>
        <li>
          <div class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
          <blockquote>‚ÄúPerfecto para desconectar. ¬°Mi familia y yo repetiremos!‚Äù</blockquote>
          <cite>‚Äî Luc√≠a T., Visitante</cite>
        </li>
        <li>
          <div class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
          <blockquote>‚ÄúEl gu√≠a explic√≥ cada planta y ave con pasi√≥n. Aprend√≠ m√°s en 4h que en un semestre.‚Äù</blockquote>
          <cite>‚Äî Dr. Javier L., Bi√≥logo</cite>
        </li>
      </ul>
    </div>
  </section>

  <section id="registro" class="contact-us-section">
    <div class="container">
      <h2>Registro y Reserva de Visita</h2>
      <p>Completa tus datos para registrarte y planificar tu visita al parque.</p>

      <form class="formulario-registro" id="registroForm">
        <div class="form-row">
          <label for="nombreCompleto">Nombre completo</label>
          <input type="text" id="nombreCompleto" name="nombreCompleto" placeholder="Tu nombre completo">
          <div class="error-message" id="error-nombreCompleto"></div>
        </div>

        <div class="form-row">
          <label for="email">Correo electr√≥nico</label>
          <input type="email" id="email" name="email" placeholder="Tu correo electr√≥nico">
          <div class="error-message" id="error-email"></div>
        </div>

        <div class="form-row">
          <label for="password">Contrase√±a</label>
          <input type="password" id="password" name="password" placeholder="Tu contrase√±a">
          <div class="error-message" id="error-password"></div>
        </div>

        <div class="form-row">
          <label for="confirmPassword">Confirmar contrase√±a</label>
          <input type="password" id="confirmPassword" name="confirmPassword" placeholder="Confirma tu contrase√±a">
          <div class="error-message" id="error-confirmPassword"></div>
        </div>

        <div class="form-row">
          <label for="telefono">Tel√©fono</label>
          <input type="tel" id="telefono" name="telefono" placeholder="Tu n√∫mero de tel√©fono">
          <div class="error-message" id="error-telefono"></div>
        </div>

        <div class="form-row">
          <label for="fechaVisita">Fecha de visita</label>
          <input type="date" id="fechaVisita" name="fechaVisita" required>
          <div class="error-message" id="error-fechaVisita"></div>
        </div>

        <div class="form-row">
          <label for="horaVisita">Hora de entrada</label>
          <input type="time" id="horaVisita" name="horaVisita" min="07:00" max="16:00" required>
          <div class="error-message" id="error-horaVisita"></div>
        </div>

        <div class="form-row">
          <label for="visitantes">N√∫mero de visitantes</label>
          <input type="number" id="visitantes" name="visitantes" min="1" max="20" step="1" placeholder="N√∫mero de personas">
          <div class="error-message" id="error-visitantes"></div>
        </div>

        <div class="form-row select-row">
          <label for="rutaPreferida">Ruta preferida</label>
          <select id="rutaPreferida" name="rutaPreferida" required>
            <option value="" disabled selected>Selecciona tu ruta preferida</option>
            <option value="mirador">Mirador del C√≥ndor (F√°cil)</option>
            <option value="canyon">Ca√±√≥n del R√≠o Claro (Moderado)</option>
            <option value="cumbre">Cumbre Altamira (Dif√≠cil)</option>
          </select>
          <div class="error-message" id="error-rutaPreferida"></div>
        </div>

        <div class="form-row checkbox-row">
          <input type="checkbox" id="guia" name="guia">
          <label for="guia">Requiero gu√≠a certificado (+$100 MXN)</label>
        </div>

        <div class="form-row checkbox-row">
          <input type="checkbox" id="terminos" name="terminos">
          <label for="terminos">Acepto los t√©rminos y condiciones</label>
          <div class="error-message" id="error-terminos"></div>
        </div>

        <button type="submit">Registrarse y Reservar</button>
      </form>
    </div>
  </section>

  <footer class="site-footer">
    <div class="container">
      <div class="footer-col">
        <h2>Parque Nacional Altamira</h2>
        <p>üìç Carretera Andina km 112<br>üìû (555) 123-4567<br>‚úâÔ∏è info@altamira.gob.mx</p>
      </div>

      <div class="footer-col">
        <h2>Enlaces r√°pidos</h2>
        <ul>
          <li><a href="#">Mapas PDF</a></li>
          <li><a href="#">Reglamento</a></li>
          <li><a href="#">Clima actual</a></li>
        </ul>
      </div>

      <div class="footer-col">
        <h2>Horarios</h2>
        <ul>
          <li>Lun‚ÄìDom: 7:00‚Äì18:00</li>
          <li>Entrada: $50 MXN</li>
          <li>Domingos: entrada libre</li>
        </ul>
      </div>

      <div class="footer-col newsletter-col">
        <h2>Newsletter</h2>
        <form class="newsletter-form">
          <label for="newsletter-email" class="sr-only">Correo para newsletter</label>
          <input type="email" id="newsletter-email" name="newsletter-email" placeholder="tu@email.com" required>
          <button type="submit">‚Üí</button>
        </form>
      </div>
    </div>
  </footer>

  <script>
    // Validaci√≥n de formulario de registro de usuarios
    // Basado en la plantilla proporcionada
    
    // Objeto para almacenar los datos del formulario
    const datos = {
        nombreCompleto: '',
        email: '',
        password: '',
        confirmPassword: '',
        telefono: '',
        fechaVisita: '',
        horaVisita: '',
        visitantes: '',
        rutaPreferida: '',
        guia: false,
        terminos: false
    }
    
    // Seleccionar los elementos del formulario
    const nombreCompleto = document.querySelector('#nombreCompleto');
    const emailForm = document.querySelector('#email');
    const password = document.querySelector('#password');
    const confirmPassword = document.querySelector('#confirmPassword');
    const telefono = document.querySelector('#telefono');
    const fechaVisita = document.querySelector('#fechaVisita');
    const horaVisita = document.querySelector('#horaVisita');
    const visitantes = document.querySelector('#visitantes');
    const rutaPreferida = document.querySelector('#rutaPreferida');
    const guia = document.querySelector('#guia');
    const terminos = document.querySelector('#terminos');
    const formulario = document.querySelector('#registroForm');
    
    // Agregar eventos de escucha para los campos del formulario
    if(nombreCompleto) nombreCompleto.addEventListener('input', leerInputs);
    if(emailForm) emailForm.addEventListener('input', leerInputs);
    if(password) password.addEventListener('input', leerInputs);
    if(confirmPassword) confirmPassword.addEventListener('input', leerInputs);
    if(telefono) telefono.addEventListener('input', leerInputs);
    if(fechaVisita) fechaVisita.addEventListener('input', leerInputs);
    if(horaVisita) horaVisita.addEventListener('input', leerInputs);
    if(visitantes) visitantes.addEventListener('input', leerInputs);
    if(rutaPreferida) rutaPreferida.addEventListener('input', leerInputs);
    if(guia) guia.addEventListener('change', leerInputs);
    if(terminos) terminos.addEventListener('change', leerInputs);
    
    // Evento para el submit del formulario
    if(formulario) {
        formulario.addEventListener('submit', function(evento) {
            evento.preventDefault();
            
            // Limpiar errores previos
            limpiarErrores();
            
            // Validar el formulario
            const errores = validarFormulario();
            
            if (Object.keys(errores).length > 0) {
                // Mostrar los errores encontrados
                mostrarErrores(errores);
                return;
            }
            
            // Si no hay errores, enviar los datos al servidor
            const formData = new FormData(formulario);
            
            fetch('registrar_usuario_reserva.php', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if(data.success) {
                    mostrarAlerta('¬°Registro y reserva completados exitosamente!', false);
                    formulario.reset();
                    // Resetear el objeto de datos
                    Object.keys(datos).forEach(key => {
                        if (typeof datos[key] === 'boolean') {
                            datos[key] = false;
                        } else {
                            datos[key] = '';
                        }
                    });
                } else {
                    mostrarAlerta('Error: ' + (data.message || 'No se pudo completar el registro'), true);
                }
            })
            .catch(error => {
                console.error('Error:', error);
                mostrarAlerta('Error al enviar los datos. Por favor, int√©ntelo de nuevo.', true);
            });
        });
    }
    
    // Funci√≥n para leer los valores de los inputs y almacenarlos en el objeto datos
    function leerInputs(evento) {
        if (evento.target.type === 'checkbox') {
            datos[evento.target.id] = evento.target.checked;
        } else {
            datos[evento.target.id] = evento.target.value;
        }
    }
    
    // Funci√≥n para validar el formulario
    function validarFormulario() {
        const errores = {};
        
        // Validar nombre completo (requerido, m√≠nimo 3 caracteres)
        if (!datos.nombreCompleto || datos.nombreCompleto.trim() === '') {
            errores.nombreCompleto = 'El nombre completo es obligatorio';
        } else if (datos.nombreCompleto.length < 3) {
            errores.nombreCompleto = 'El nombre debe tener al menos 3 caracteres';
        }
        
        // Validar correo electr√≥nico (formato v√°lido)
        if (!datos.email || datos.email.trim() === '') {
            errores.email = 'El correo electr√≥nico es obligatorio';
        } else if (!validarEmail(datos.email)) {
            errores.email = 'Por favor ingrese un correo electr√≥nico v√°lido';
        }
        
        // Validar contrase√±a (m√≠nimo 8 caracteres)
        if (!datos.password || datos.password.trim() === '') {
            errores.password = 'La contrase√±a es obligatoria';
        } else if (datos.password.length < 8) {
            errores.password = 'La contrase√±a debe tener al menos 8 caracteres';
        }
        
        // Validar confirmaci√≥n de contrase√±a (debe coincidir con la anterior)
        if (!datos.confirmPassword || datos.confirmPassword.trim() === '') {
            errores.confirmPassword = 'Debe confirmar la contrase√±a';
        } else if (datos.password !== datos.confirmPassword) {
            errores.confirmPassword = 'Las contrase√±as no coinciden';
        }
        
        // Validar tel√©fono (formato opcional, pero si se ingresa debe ser v√°lido)
        if (datos.telefono && datos.telefono.trim() !== '') {
            const telefonoRegex = /^[0-9\-\+\(\)\s]+$/;
            if (!telefonoRegex.test(datos.telefono)) {
                errores.telefono = 'Por favor ingrese un n√∫mero de tel√©fono v√°lido';
            }
        }
        
        // Validar fecha de visita (requerida)
        if (!datos.fechaVisita || datos.fechaVisita.trim() === '') {
            errores.fechaVisita = 'La fecha de visita es obligatoria';
        } else {
            // Validar que la fecha no sea anterior a hoy
            const fechaIngresada = new Date(datos.fechaVisita);
            const fechaHoy = new Date();
            fechaHoy.setHours(0, 0, 0, 0); // Establecer hora a 00:00:00 para comparaci√≥n precisa
            if (fechaIngresada < fechaHoy) {
                errores.fechaVisita = 'La fecha de visita no puede ser anterior a hoy';
            }
        }
        
        // Validar hora de visita (requerida)
        if (!datos.horaVisita || datos.horaVisita.trim() === '') {
            errores.horaVisita = 'La hora de visita es obligatoria';
        }
        
        // Validar n√∫mero de visitantes (requerido, entre 1 y 20)
        if (!datos.visitantes || datos.visitantes.trim() === '') {
            errores.visitantes = 'El n√∫mero de visitantes es obligatorio';
        } else if (isNaN(datos.visitantes) || parseInt(datos.visitantes) < 1 || parseInt(datos.visitantes) > 20) {
            errores.visitantes = 'El n√∫mero de visitantes debe estar entre 1 y 20';
        }
        
        // Validar ruta preferida (requerida)
        if (!datos.rutaPreferida || datos.rutaPreferida.trim() === '') {
            errores.rutaPreferida = 'Debe seleccionar una ruta preferida';
        }
        
        // Validar aceptar t√©rminos y condiciones (checkbox obligatorio)
        if (!datos.terminos) {
            errores.terminos = 'Debe aceptar los t√©rminos y condiciones';
        }
        
        return errores;
    }
    
    // Funci√≥n para validar formato de email
    function validarEmail(email) {
        const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return regex.test(email);
    }
    
    // Funci√≥n para mostrar errores espec√≠ficos
    function mostrarErrores(errores) {
        Object.keys(errores).forEach(campo => {
            const elementoError = document.getElementById(`error-${campo}`);
            if (elementoError) {
                elementoError.textContent = errores[campo];
                // Agregar clase de error al campo correspondiente
                const campoElemento = document.getElementById(campo);
                if (campoElemento) {
                    campoElemento.classList.add('error-campo');
                }
            }
        });
    }
    
    // Funci√≥n para limpiar mensajes de error
    function limpiarErrores() {
        // Limpiar mensajes de error espec√≠ficos del formulario de registro
        const mensajesError = document.querySelectorAll('#registroForm .error-message');
        mensajesError.forEach(mensaje => {
            mensaje.textContent = '';
        });
        
        // Remover clases de error de los campos
        const campos = document.querySelectorAll('#registroForm input, #registroForm select');
        campos.forEach(campo => {
            campo.classList.remove('error-campo');
        });
    }
    
    // Funci√≥n para mostrar alertas
    function mostrarAlerta(mensaje, error = null) {
        // Crear elemento de alerta
        const alerta = document.createElement('P');
        alerta.textContent = mensaje;
        if (error) {
            alerta.classList.add('error');
        } else {
            alerta.classList.add('exito');
        }
        
        // Insertar la alerta antes del bot√≥n de submit
        const botonSubmit = document.querySelector('#registroForm button[type="submit"]');
        if(botonSubmit) {
            botonSubmit.parentNode.insertBefore(alerta, botonSubmit);
        }
        
        // Eliminar la alerta despu√©s de 3 segundos
        setTimeout(() => {
            alerta.remove();
        }, 3000);
    }
    
    // Cargar rutas desde la base de datos
    document.addEventListener('DOMContentLoaded', function() {
        cargarRutas();
    });
    
    function cargarRutas() {
        fetch('obtener_rutas.php')
            .then(response => response.json())
            .then(rutas => {
                const container = document.getElementById('rutas-container');
                if (rutas.length > 0) {
                    let rutasHTML = '<div class="rutas-grid">';
                    rutas.forEach(ruta => {
                        rutasHTML += `
                            <div class="ruta-card">
                                <h4>${ruta.nombre || 'Nombre no disponible'}</h4>
                                <p><strong>Locaci√≥n:</strong> ${ruta.locacion || 'No especificada'}</p>
                                <p><strong>Dificultad:</strong> <span class="ruta-dificultad dificultad-${ruta.dificultad || '0'}">Clase ${ruta.dificultad || 'Desconocida'}</span></p>
                                <p><strong>Rating:</strong> <span class="ruta-rating">${'‚òÖ'.repeat(parseInt(ruta.rating) || 0)}</span></p>
                            </div>
                        `;
                    });
                    rutasHTML += '</div>';
                    container.innerHTML = rutasHTML;
                } else {
                    container.innerHTML = '<p>No hay rutas registradas a√∫n.</p>';
                }
            })
            .catch(error => {
                console.error('Error al cargar las rutas:', error);
                const container = document.getElementById('rutas-container');
                container.innerHTML = '<p>Error al cargar las rutas. Intente nuevamente m√°s tarde.</p>';
            });
    }
  </script>
</body>
</html>
